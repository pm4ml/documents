<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1104px" preserveAspectRatio="none" style="width:1618px;height:1104px;" version="1.1" viewBox="0 0 1618 1104" width="1618px" zoomAndPan="magnify"><defs><filter height="300%" id="fszb5evd5ldox" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1092.5" style="stroke:#383838;stroke-width:1.0;" width="594" x="435" y="6"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="205" x="629.5" y="30.9141">Payment Manager</text><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="125" x2="125" y1="89.375" y2="1046.3125"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="532" x2="532" y1="89.375" y2="1046.3125"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="908" x2="908" y1="89.375" y2="1046.3125"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1262" x2="1262" y1="89.375" y2="1046.3125"/><rect fill="#F8F8F8" filter="url(#fszb5evd5ldox)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="237" x="5" y="40.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="223" x="12" y="72.1016">DFSP Core Backend</text><rect fill="#F8F8F8" filter="url(#fszb5evd5ldox)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="237" x="5" y="1045.3125"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="223" x="12" y="1077.2266">DFSP Core Backend</text><rect fill="#F8F8F8" filter="url(#fszb5evd5ldox)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="183" x="439" y="40.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="169" x="446" y="72.1016">Core Connector</text><rect fill="#F8F8F8" filter="url(#fszb5evd5ldox)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="183" x="439" y="1045.3125"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="169" x="446" y="1077.2266">Core Connector</text><rect fill="#F8F8F8" filter="url(#fszb5evd5ldox)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="229" x="792" y="40.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="215" x="799" y="72.1016">Mojaloop Connector</text><rect fill="#F8F8F8" filter="url(#fszb5evd5ldox)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="229" x="792" y="1045.3125"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="215" x="799" y="1077.2266">Mojaloop Connector</text><rect fill="#F8F8F8" filter="url(#fszb5evd5ldox)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="189" x="1166" y="40.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="175" x="1173" y="72.1016">Mojaloop Switch</text><rect fill="#F8F8F8" filter="url(#fszb5evd5ldox)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="189" x="1166" y="1045.3125"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="175" x="1173" y="1077.2266">Mojaloop Switch</text><rect fill="#EEEEEE" filter="url(#fszb5evd5ldox)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1611.5" x="0" y="127.4688"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1611.5" y1="127.4688" y2="127.4688"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1611.5" y1="130.4688" y2="130.4688"/><rect fill="#EEEEEE" filter="url(#fszb5evd5ldox)" height="38.1875" style="stroke:#000000;stroke-width:2.0;" width="161" x="725.25" y="109.375"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="140" x="731.25" y="138.2891">send money</text><polygon fill="#383838" points="520.5,189.75,530.5,193.75,520.5,197.75,524.5,193.75" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="125.5" x2="526.5" y1="193.75" y2="193.75"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="132.5" y="186.4766">1</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="277" x="149.5" y="186.4766">POST /sendmoney (sync)</text><polygon fill="#383838" points="896.5,233.9375,906.5,237.9375,896.5,241.9375,900.5,237.9375" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="532.5" x2="902.5" y1="237.9375" y2="237.9375"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="539.5" y="230.6641">2</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="246" x="556.5" y="230.6641">POST /transfers (sync)</text><polygon fill="#383838" points="1250.5,278.125,1260.5,282.125,1250.5,286.125,1254.5,282.125" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="908.5" x2="1256.5" y1="282.125" y2="282.125"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="915.5" y="274.8516">3</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="246" x="932.5" y="274.8516">GET /parties/{type}/{id}</text><polygon fill="#383838" points="919.5,322.3125,909.5,326.3125,919.5,330.3125,915.5,326.3125" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="913.5" x2="1261.5" y1="326.3125" y2="326.3125"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="925.5" y="319.0391">4</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="244" x="942.5" y="319.0391">PUT /parties/{type}/{id}</text><polygon fill="#383838" points="1250.5,366.5,1260.5,370.5,1250.5,374.5,1254.5,370.5" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="908.5" x2="1256.5" y1="370.5" y2="370.5"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="915.5" y="363.2266">5</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="152" x="932.5" y="363.2266">POST /quotes</text><polygon fill="#383838" points="919.5,410.6875,909.5,414.6875,919.5,418.6875,915.5,414.6875" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="913.5" x2="1261.5" y1="414.6875" y2="414.6875"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="925.5" y="407.4141">6</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="176" x="942.5" y="407.4141">PUT /quotes/{id}</text><line style="stroke:#383838;stroke-width:1.0;" x1="908.5" x2="950.5" y1="458.875" y2="458.875"/><line style="stroke:#383838;stroke-width:1.0;" x1="950.5" x2="950.5" y1="458.875" y2="471.875"/><line style="stroke:#383838;stroke-width:1.0;" x1="909.5" x2="950.5" y1="471.875" y2="471.875"/><polygon fill="#383838" points="919.5,467.875,909.5,471.875,919.5,475.875,915.5,471.875" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="915.5" y="451.6016">7</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="196" x="932.5" y="451.6016">Check quote rules</text><polygon fill="#383838" points="1250.5,512.0625,1260.5,516.0625,1250.5,520.0625,1254.5,516.0625" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="908.5" x2="1256.5" y1="516.0625" y2="516.0625"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="915.5" y="508.7891">8</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="173" x="932.5" y="508.7891">POST /transfers</text><line style="stroke:#383838;stroke-width:1.0;" x1="1262.5" x2="1304.5" y1="560.25" y2="560.25"/><line style="stroke:#383838;stroke-width:1.0;" x1="1304.5" x2="1304.5" y1="560.25" y2="573.25"/><line style="stroke:#383838;stroke-width:1.0;" x1="1263.5" x2="1304.5" y1="573.25" y2="573.25"/><polygon fill="#383838" points="1273.5,569.25,1263.5,573.25,1273.5,577.25,1269.5,573.25" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="13" x="1269.5" y="552.9766">9</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="318" x="1286.5" y="552.9766">Perform (NDC) liquidity check</text><line style="stroke:#383838;stroke-width:1.0;" x1="1262.5" x2="1304.5" y1="617.4375" y2="617.4375"/><line style="stroke:#383838;stroke-width:1.0;" x1="1304.5" x2="1304.5" y1="617.4375" y2="630.4375"/><line style="stroke:#383838;stroke-width:1.0;" x1="1263.5" x2="1304.5" y1="630.4375" y2="630.4375"/><polygon fill="#383838" points="1273.5,626.4375,1263.5,630.4375,1273.5,634.4375,1269.5,630.4375" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1269.5" y="610.1641">10</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="155" x="1299.5" y="610.1641">Reserve funds</text><line style="stroke:#383838;stroke-width:1.0;" x1="1262.5" x2="1304.5" y1="674.625" y2="674.625"/><line style="stroke:#383838;stroke-width:1.0;" x1="1304.5" x2="1304.5" y1="674.625" y2="687.625"/><line style="stroke:#383838;stroke-width:1.0;" x1="1263.5" x2="1304.5" y1="687.625" y2="687.625"/><polygon fill="#383838" points="1273.5,683.625,1263.5,687.625,1273.5,691.625,1269.5,687.625" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1269.5" y="667.3516">11</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="193" x="1299.5" y="667.3516">Perform validation</text><line style="stroke:#383838;stroke-width:1.0;" x1="1262.5" x2="1304.5" y1="731.8125" y2="731.8125"/><line style="stroke:#383838;stroke-width:1.0;" x1="1304.5" x2="1304.5" y1="731.8125" y2="744.8125"/><line style="stroke:#383838;stroke-width:1.0;" x1="1263.5" x2="1304.5" y1="744.8125" y2="744.8125"/><polygon fill="#383838" points="1273.5,740.8125,1263.5,744.8125,1273.5,748.8125,1269.5,744.8125" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="26" x="1269.5" y="724.5391">12</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="150" x="1299.5" y="724.5391">Commit funds</text><polygon fill="#383838" points="919.5,815.1875,909.5,819.1875,919.5,823.1875,915.5,819.1875" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="913.5" x2="1261.5" y1="819.1875" y2="819.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="26" x="925.5" y="796.8203">13</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="197" x="955.5" y="781.7266">PUT /transfers/{id}</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="293" x="962.5" y="811.9141">transferState=COMMITTED</text><polygon fill="#383838" points="543.5,919.75,533.5,923.75,543.5,927.75,539.5,923.75" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="537.5" x2="907.5" y1="923.75" y2="923.75"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="26" x="549.5" y="886.2891">14</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="315" x="579.5" y="856.1016">Response to POST /transfers</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="210" x="586.5" y="886.2891">Transfer successful</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="247" x="586.5" y="916.4766">HTTP 200 result (sync)</text><polygon fill="#383838" points="136.5,1024.3125,126.5,1028.3125,136.5,1032.3125,132.5,1028.3125" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="130.5" x2="531.5" y1="1028.3125" y2="1028.3125"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacing" textLength="26" x="142.5" y="990.8516">15</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="346" x="172.5" y="960.6641">Response to POST /sendmoney</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="210" x="179.5" y="990.8516">Transfer successful</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacing" textLength="247" x="179.5" y="1021.0391">HTTP 200 result (sync)</text><!--MD5=[3bb178dd1adf08df8ce36bf752cd98e3]
@startuml

autonumber
skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 24
skinparam defaultFontSize 24
skinparam noteFontSize 24
skinparam monochrome true

participant "DFSP Core Backend" as backend

box Payment Manager
participant "Core Connector" as cc
participant "Mojaloop Connector" as sob
end box

participant "Mojaloop Switch" as sw


== send money ==

    backend -> cc: POST /sendmoney (sync)
    cc->sob: POST /transfers (sync)
    sob -> sw: GET /parties/{type}/{id}
    sw -> sob: PUT /parties/{type}/{id}
    sob -> sw: POST /quotes
    sw -> sob: PUT /quotes/{id}
    sob -> sob: Check quote rules
    sob -> sw: POST /transfers
    sw -> sw: Perform (NDC) liquidity check
    sw -> sw: Reserve funds
    sw -> sw: Perform validation
    sw -> sw: Commit funds
    sw -> sob: PUT /transfers/{id} \n transferState=COMMITTED
    sob -> cc: Response to POST /transfers \n Transfer successful \n HTTP 200 result (sync)
    cc -> backend: Response to POST /sendmoney \n Transfer successful \n HTTP 200 result (sync)

@enduml

PlantUML version 1.2021.00(Sun Jan 10 11:25:05 CET 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1250
Language: en
Country: US
--></g></svg>