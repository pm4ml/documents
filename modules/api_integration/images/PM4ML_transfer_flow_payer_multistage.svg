<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="837px" preserveAspectRatio="none" style="width:935px;height:837px;" version="1.1" viewBox="0 0 935 837" width="935px" zoomAndPan="magnify"><defs><filter height="300%" id="f1j44mdjre273r" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="125" x2="125" y1="54.1875" y2="780.1875"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="539.5" x2="539.5" y1="54.1875" y2="780.1875"/><line style="stroke:#383838;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="826" x2="826" y1="54.1875" y2="780.1875"/><rect fill="#F8F8F8" filter="url(#f1j44mdjre273r)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="237" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="223" x="12" y="36.9141">DFSP Core Backend</text><rect fill="#F8F8F8" filter="url(#f1j44mdjre273r)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="237" x="5" y="779.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="223" x="12" y="811.1016">DFSP Core Backend</text><rect fill="#F8F8F8" filter="url(#f1j44mdjre273r)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="210" x="432.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="196" x="439.5" y="36.9141">Payment Manager</text><rect fill="#F8F8F8" filter="url(#f1j44mdjre273r)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="210" x="432.5" y="779.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="196" x="439.5" y="811.1016">Payment Manager</text><rect fill="#F8F8F8" filter="url(#f1j44mdjre273r)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="189" x="730" y="5"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="175" x="737" y="36.9141">Mojaloop Switch</text><rect fill="#F8F8F8" filter="url(#f1j44mdjre273r)" height="44.1875" style="stroke:#383838;stroke-width:1.5;" width="189" x="730" y="779.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="175" x="737" y="811.1016">Mojaloop Switch</text><rect fill="#EEEEEE" filter="url(#f1j44mdjre273r)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="928" x="0" y="92.2813"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="928" y1="92.2813" y2="92.2813"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="928" y1="95.2813" y2="95.2813"/><rect fill="#EEEEEE" filter="url(#f1j44mdjre273r)" height="38.1875" style="stroke:#000000;stroke-width:2.0;" width="161" x="383.5" y="74.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="389.5" y="103.1016">send money</text><polygon fill="#383838" points="527.5,154.5625,537.5,158.5625,527.5,162.5625,531.5,158.5625" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="125.5" x2="533.5" y1="158.5625" y2="158.5625"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="132.5" y="151.2891">1</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="246" x="149.5" y="151.2891">POST /transfers (sync)</text><polygon fill="#383838" points="814.5,198.75,824.5,202.75,814.5,206.75,818.5,202.75" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="539.5" x2="820.5" y1="202.75" y2="202.75"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="546.5" y="195.4766">2</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="246" x="563.5" y="195.4766">GET /parties/{type}/{id}</text><polygon fill="#383838" points="550.5,242.9375,540.5,246.9375,550.5,250.9375,546.5,246.9375" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="544.5" x2="825.5" y1="246.9375" y2="246.9375"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="556.5" y="239.6641">3</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="244" x="573.5" y="239.6641">PUT /parties/{type}/{id}</text><polygon fill="#383838" points="136.5,287.125,126.5,291.125,136.5,295.125,132.5,291.125" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="130.5" x2="538.5" y1="291.125" y2="291.125"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="142.5" y="283.8516">4</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="241" x="159.5" y="283.8516">HTTP 200 party (sync)</text><polygon fill="#383838" points="527.5,361.5,537.5,365.5,527.5,369.5,531.5,365.5" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="125.5" x2="533.5" y1="365.5" y2="365.5"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="132.5" y="343.1328">5</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="353" x="149.5" y="328.0391">PUT /transfers/{transferId} (sync)</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="217" x="156.5" y="358.2266">("acceptParty": true)</text><polygon fill="#383838" points="814.5,405.6875,824.5,409.6875,814.5,413.6875,818.5,409.6875" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="539.5" x2="820.5" y1="409.6875" y2="409.6875"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="546.5" y="402.4141">6</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="152" x="563.5" y="402.4141">POST /quotes</text><polygon fill="#383838" points="550.5,449.875,540.5,453.875,550.5,457.875,546.5,453.875" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="544.5" x2="825.5" y1="453.875" y2="453.875"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="556.5" y="446.6016">7</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="176" x="573.5" y="446.6016">PUT /quotes/{id}</text><line style="stroke:#383838;stroke-width:1.0;" x1="539.5" x2="581.5" y1="498.0625" y2="498.0625"/><line style="stroke:#383838;stroke-width:1.0;" x1="581.5" x2="581.5" y1="498.0625" y2="511.0625"/><line style="stroke:#383838;stroke-width:1.0;" x1="540.5" x2="581.5" y1="511.0625" y2="511.0625"/><polygon fill="#383838" points="550.5,507.0625,540.5,511.0625,550.5,515.0625,546.5,511.0625" style="stroke:#383838;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="546.5" y="490.7891">8</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="191" x="563.5" y="490.7891">check quote rules</text><polygon fill="#383838" points="136.5,551.25,126.5,555.25,136.5,559.25,132.5,555.25" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="130.5" x2="538.5" y1="555.25" y2="555.25"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="142.5" y="547.9766">9</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="248" x="159.5" y="547.9766">HTTP 200 quote (sync)</text><polygon fill="#383838" points="527.5,625.625,537.5,629.625,527.5,633.625,531.5,629.625" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="125.5" x2="533.5" y1="629.625" y2="629.625"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="132.5" y="607.2578">10</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="353" x="162.5" y="592.1641">PUT /transfers/{transferId} (sync)</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="227" x="169.5" y="622.3516">("acceptQuote": true)</text><polygon fill="#383838" points="814.5,669.8125,824.5,673.8125,814.5,677.8125,818.5,673.8125" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="539.5" x2="820.5" y1="673.8125" y2="673.8125"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="546.5" y="666.5391">11</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="173" x="576.5" y="666.5391">POST /transfers</text><polygon fill="#383838" points="550.5,714,540.5,718,550.5,722,546.5,718" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="544.5" x2="825.5" y1="718" y2="718"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="556.5" y="710.7266">12</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="197" x="586.5" y="710.7266">PUT /transfers/{id}</text><polygon fill="#383838" points="136.5,758.1875,126.5,762.1875,136.5,766.1875,132.5,762.1875" style="stroke:#383838;stroke-width:1.0;"/><line style="stroke:#383838;stroke-width:1.0;" x1="130.5" x2="538.5" y1="762.1875" y2="762.1875"/><text fill="#000000" font-family="sans-serif" font-size="24" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="142.5" y="754.9141">13</text><text fill="#000000" font-family="sans-serif" font-size="24" lengthAdjust="spacingAndGlyphs" textLength="247" x="172.5" y="754.9141">HTTP 200 result (sync)</text><!--MD5=[c1647d7f25c96af7778fcbeb4b5752fd]
@startuml

autonumber
skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 24
skinparam defaultFontSize 24
skinparam noteFontSize 24
skinparam monochrome true

participant "DFSP Core Backend" as backend

participant "Payment Manager" as sob

participant "Mojaloop Switch" as sw


== send money ==

    backend -> sob: POST /transfers (sync)
    
    sob -> sw: GET /parties/{type}/{id}
    sw -> sob: PUT /parties/{type}/{id}

    sob -> backend: HTTP 200 party (sync)
    backend -> sob: PUT /transfers/{transferId} (sync) \n ("acceptParty": true)

    sob -> sw: POST /quotes
    sw -> sob: PUT /quotes/{id}
    sob -> sob: check quote rules

    sob -> backend: HTTP 200 quote (sync)
    backend -> sob: PUT /transfers/{transferId} (sync) \n ("acceptQuote": true)

    sob -> sw: POST /transfers
    sw -> sob: PUT /transfers/{id}
    
    sob -> backend: HTTP 200 result (sync)

@enduml

PlantUML version 1.2020.22(Sun Dec 06 10:36:27 CET 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1250
Language: en
Country: US
--></g></svg>